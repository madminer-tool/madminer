{"applied": [{"type": "offset", "id": "e6009a20-6641-44e6-b1d2-eae42d97974c", "rule": {"dependencies": {"dependency_type": "jsonpath_ready", "expressions": []}, "type": "JsonStage", "name": "init", "scheduler": {"inputs": [], "nodename": null, "parameters": {"combinedfile": "inputs/madminer_example_with_data_1.h5", "ntrainsamples": "2", "inputfile": "inputs/input_ML.yml"}, "discover": true, "relative": true, "scheduler_type": "init-stage"}, "state_provider": {"init_states": [{"state_type": "localfs", "readwrite": [], "readonly": ["/home/irina/Projects/madminer/encapsulation/workflows"], "identifier": "unidentified_state"}], "nest": true, "base_state": {"state_type": "localfs", "readwrite": ["/home/irina/Projects/madminer/encapsulation/workflows/workdir"], "readonly": [], "identifier": "unidentified_state"}, "state_provider_type": "localfs_provider", "sub_init_states": {}, "ensure": true}}, "offset": ""}, {"type": "offset", "id": "d4264f9d-38a8-408f-87fc-4641f882ee45", "rule": {"dependencies": {"dependency_type": "jsonpath_ready", "expressions": ["init"]}, "type": "JsonStage", "name": "sampling", "scheduler": {"step": {"process": {"interpreter": "sh", "process_type": "interpolated-script-cmd", "script": "mkdir /home/data\nmkdir /home/data/samples\npython code/configurate_ml.py {n_trainsamples} {combined_file} {input_file}\nfor i in `seq 0 $(({n_trainsamples}-1))`; do  tar -czvf /home/data/Samples_$i.tar.gz /home/data/Samples_$i/*; done \ncp -R /home/data/Samples*.tar.gz {sampleworkdir}\n"}, "publisher": {"publisher_type": "fromglob-pub", "outputkey": "sampling_file", "globexpression": "Samples_*.tar.gz"}, "environment": {"workdir": null, "imagetag": "latest", "par_mounts": [], "image": "irinahub/docker-madminer-ml", "envscript": "", "environment_type": "docker-encapsulated", "env": {}, "resources": []}}, "scheduler_type": "singlestep-stage", "parameters": [{"key": "n_trainsamples", "value": {"output": "ntrainsamples", "step": "init", "expression_type": "stage-output-selector"}}, {"key": "outputfile", "value": "{workdir}/outputfile.txt"}, {"key": "combined_file", "value": {"output": "combinedfile", "step": "init", "expression_type": "stage-output-selector"}}, {"key": "input_file", "value": {"output": "inputfile", "step": "init", "expression_type": "stage-output-selector"}}, {"key": "sampleworkdir", "value": "{workdir}"}]}, "state_provider": {"init_states": [{"state_type": "localfs", "readwrite": [], "readonly": ["/home/irina/Projects/madminer/encapsulation/workflows"], "identifier": "unidentified_state"}], "nest": true, "base_state": {"state_type": "localfs", "readwrite": ["/home/irina/Projects/madminer/encapsulation/workflows/workdir"], "readonly": [], "identifier": "unidentified_state"}, "state_provider_type": "localfs_provider", "sub_init_states": {}, "ensure": true}}, "offset": ""}, {"type": "offset", "id": "ef18f3c3-6f3c-4ce4-80de-d449f2a6b6a9", "rule": {"dependencies": {"dependency_type": "jsonpath_ready", "expressions": ["sampling"]}, "type": "JsonStage", "name": "training", "scheduler": {"step": {"process": {"interpreter": "sh", "process_type": "interpolated-script-cmd", "script": "mkdir /home/extract\nmkdir /home/models\ntar -xvzf {trainfolder} -C /home/extract\nmv /home/extract/home/data/Samples_*  /home/extract/home/data/Samples\nls -R /home > {outputfile}\npython code/train.py /home/extract/home/data/Samples {input_file}\ncp -R /home/models/*  {trainworkdir}\n"}, "publisher": {"publisher_type": "interpolated-pub", "glob": false, "relative_paths": false, "publish": {"training_file": "{outputfile}"}}, "environment": {"workdir": null, "imagetag": "latest", "par_mounts": [], "image": "irinahub/docker-madminer-ml", "envscript": "", "environment_type": "docker-encapsulated", "env": {}, "resources": []}}, "scheduler_type": "multistep-stage", "scatter": {"method": "zip", "parameters": ["trainfolder"]}, "parameters": [{"key": "outputfile", "value": "{workdir}/output.txt"}, {"key": "trainfolder", "value": {"output": "sampling_file", "step": "sampling", "expression_type": "stage-output-selector", "unwrap": true}}, {"key": "trainworkdir", "value": "{workdir}"}, {"key": "input_file", "value": {"output": "inputfile", "step": "init", "expression_type": "stage-output-selector"}}]}, "state_provider": {"init_states": [{"state_type": "localfs", "readwrite": [], "readonly": ["/home/irina/Projects/madminer/encapsulation/workflows"], "identifier": "unidentified_state"}], "nest": true, "base_state": {"state_type": "localfs", "readwrite": ["/home/irina/Projects/madminer/encapsulation/workflows/workdir"], "readonly": [], "identifier": "unidentified_state"}, "state_provider_type": "localfs_provider", "sub_init_states": {}, "ensure": true}}, "offset": ""}], "dag": {"nodes": [{"task": {"inputs": [{"stepid": "18b28d74-fa2e-451a-85d7-89814d04a7e9", "pointer_path": "/ntrainsamples"}, {"stepid": "18b28d74-fa2e-451a-85d7-89814d04a7e9", "pointer_path": "/combinedfile"}, {"stepid": "18b28d74-fa2e-451a-85d7-89814d04a7e9", "pointer_path": "/inputfile"}], "parameters": {"n_trainsamples": "2", "sampleworkdir": "{workdir}", "outputfile": "{workdir}/outputfile.txt", "input_file": "/home/irina/Projects/madminer/encapsulation/workflows/inputs/input_ML.yml", "combined_file": "/home/irina/Projects/madminer/encapsulation/workflows/inputs/madminer_example_with_data_1.h5"}, "state": {"state_type": "localfs", "readwrite": ["/home/irina/Projects/madminer/encapsulation/workflows/workdir/sampling"], "readonly": ["/home/irina/Projects/madminer/encapsulation/workflows"], "identifier": "sampling"}, "type": "packtivity_task", "spec": {"process": {"interpreter": "sh", "process_type": "interpolated-script-cmd", "script": "mkdir /home/data\nmkdir /home/data/samples\npython code/configurate_ml.py {n_trainsamples} {combined_file} {input_file}\nfor i in `seq 0 $(({n_trainsamples}-1))`; do  tar -czvf /home/data/Samples_$i.tar.gz /home/data/Samples_$i/*; done \ncp -R /home/data/Samples*.tar.gz {sampleworkdir}\n"}, "publisher": {"publisher_type": "fromglob-pub", "outputkey": "sampling_file", "globexpression": "Samples_*.tar.gz"}, "environment": {"workdir": null, "imagetag": "latest", "par_mounts": [], "image": "irinahub/docker-madminer-ml", "envscript": "", "environment_type": "docker-encapsulated", "env": {}, "resources": []}}, "metadata": {"wflow_hints": {"is_purepub": false}, "name": "sampling", "wflow_stage_node_idx": 0, "wflow_offset": "", "wflow_stage": "sampling", "wflow_node_id": "2961f93a-00a4-4d91-bf16-73e7ba96bb28"}}, "name": "sampling", "state": "SUCCESS", "proxy": {"proxyname": "PacktivityProxyBase", "proxydetails": null}, "timestamps": {"defined": 1549318213.539113, "ready by": 1549318217.082057, "submit": 1549318213.922723}, "id": "2961f93a-00a4-4d91-bf16-73e7ba96bb28", "result": {"sampling_file": ["/home/irina/Projects/madminer/encapsulation/workflows/workdir/sampling/Samples_1.tar.gz", "/home/irina/Projects/madminer/encapsulation/workflows/workdir/sampling/Samples_0.tar.gz"]}}, {"task": {"inputs": [{"stepid": "2961f93a-00a4-4d91-bf16-73e7ba96bb28", "pointer_path": "/sampling_file/0"}, {"stepid": "18b28d74-fa2e-451a-85d7-89814d04a7e9", "pointer_path": "/inputfile"}], "parameters": {"outputfile": "{workdir}/output.txt", "trainfolder": "/home/irina/Projects/madminer/encapsulation/workflows/workdir/sampling/Samples_1.tar.gz", "trainworkdir": "{workdir}", "input_file": "/home/irina/Projects/madminer/encapsulation/workflows/inputs/input_ML.yml"}, "state": {"state_type": "localfs", "readwrite": ["/home/irina/Projects/madminer/encapsulation/workflows/workdir/training_0"], "readonly": ["/home/irina/Projects/madminer/encapsulation/workflows", "/home/irina/Projects/madminer/encapsulation/workflows/workdir/sampling"], "identifier": "training_0"}, "type": "packtivity_task", "spec": {"process": {"interpreter": "sh", "process_type": "interpolated-script-cmd", "script": "mkdir /home/extract\nmkdir /home/models\ntar -xvzf {trainfolder} -C /home/extract\nmv /home/extract/home/data/Samples_*  /home/extract/home/data/Samples\nls -R /home > {outputfile}\npython code/train.py /home/extract/home/data/Samples {input_file}\ncp -R /home/models/*  {trainworkdir}\n"}, "publisher": {"publisher_type": "interpolated-pub", "glob": false, "relative_paths": false, "publish": {"training_file": "{outputfile}"}}, "environment": {"workdir": null, "imagetag": "latest", "par_mounts": [], "image": "irinahub/docker-madminer-ml", "envscript": "", "environment_type": "docker-encapsulated", "env": {}, "resources": []}}, "metadata": {"wflow_hints": {"is_purepub": false}, "name": "training_0", "wflow_stage_node_idx": 0, "wflow_offset": "", "wflow_stage": "training", "wflow_node_id": "5effdee9-6a23-4c9f-a9a1-329cd10e77e7"}}, "name": "training_0", "state": "SUCCESS", "proxy": {"proxyname": "PacktivityProxyBase", "proxydetails": null}, "timestamps": {"defined": 1549318217.19536, "ready by": 1549318221.04622, "submit": 1549318217.42669}, "id": "5effdee9-6a23-4c9f-a9a1-329cd10e77e7", "result": {"training_file": "/home/irina/Projects/madminer/encapsulation/workflows/workdir/training_0/output.txt"}}, {"task": {"inputs": [], "parameters": {"inputfile": "inputs/input_ML.yml", "ntrainsamples": "2", "combinedfile": "inputs/madminer_example_with_data_1.h5"}, "state": {"state_type": "localfs", "readwrite": [], "readonly": ["/home/irina/Projects/madminer/encapsulation/workflows"], "identifier": "init"}, "type": "packtivity_task", "spec": {"process": null, "environment": null, "publisher": {"tryExact": true, "publisher_type": "fromparjq-pub", "glob": true, "relative_paths": true, "script": "."}}, "metadata": {"wflow_hints": {"is_purepub": true}, "name": "init", "wflow_stage_node_idx": 0, "wflow_offset": "", "wflow_stage": "init", "wflow_node_id": "18b28d74-fa2e-451a-85d7-89814d04a7e9"}}, "name": "init", "state": "SUCCESS", "proxy": {"proxyname": "ForegroundProxy", "proxydetails": {"success": true, "resultdata": {"inputfile": "/home/irina/Projects/madminer/encapsulation/workflows/inputs/input_ML.yml", "ntrainsamples": "2", "combinedfile": "/home/irina/Projects/madminer/encapsulation/workflows/inputs/madminer_example_with_data_1.h5"}, "labels": {"backend_hints": "is_purepub"}, "datamodel": null}}, "timestamps": {"defined": 1549318213.373116, "ready by": 1549318213.908486, "submit": 1549318213.746051}, "id": "18b28d74-fa2e-451a-85d7-89814d04a7e9", "result": {"inputfile": "/home/irina/Projects/madminer/encapsulation/workflows/inputs/input_ML.yml", "ntrainsamples": "2", "combinedfile": "/home/irina/Projects/madminer/encapsulation/workflows/inputs/madminer_example_with_data_1.h5"}}, {"task": {"inputs": [{"stepid": "2961f93a-00a4-4d91-bf16-73e7ba96bb28", "pointer_path": "/sampling_file/1"}, {"stepid": "18b28d74-fa2e-451a-85d7-89814d04a7e9", "pointer_path": "/inputfile"}], "parameters": {"outputfile": "{workdir}/output.txt", "trainfolder": "/home/irina/Projects/madminer/encapsulation/workflows/workdir/sampling/Samples_0.tar.gz", "trainworkdir": "{workdir}", "input_file": "/home/irina/Projects/madminer/encapsulation/workflows/inputs/input_ML.yml"}, "state": {"state_type": "localfs", "readwrite": ["/home/irina/Projects/madminer/encapsulation/workflows/workdir/training_1"], "readonly": ["/home/irina/Projects/madminer/encapsulation/workflows", "/home/irina/Projects/madminer/encapsulation/workflows/workdir/sampling"], "identifier": "training_1"}, "type": "packtivity_task", "spec": {"process": {"interpreter": "sh", "process_type": "interpolated-script-cmd", "script": "mkdir /home/extract\nmkdir /home/models\ntar -xvzf {trainfolder} -C /home/extract\nmv /home/extract/home/data/Samples_*  /home/extract/home/data/Samples\nls -R /home > {outputfile}\npython code/train.py /home/extract/home/data/Samples {input_file}\ncp -R /home/models/*  {trainworkdir}\n"}, "publisher": {"publisher_type": "interpolated-pub", "glob": false, "relative_paths": false, "publish": {"training_file": "{outputfile}"}}, "environment": {"workdir": null, "imagetag": "latest", "par_mounts": [], "image": "irinahub/docker-madminer-ml", "envscript": "", "environment_type": "docker-encapsulated", "env": {}, "resources": []}}, "metadata": {"wflow_hints": {"is_purepub": false}, "name": "training_1", "wflow_stage_node_idx": 1, "wflow_offset": "", "wflow_stage": "training", "wflow_node_id": "eb8bdb34-b22b-4979-b19f-d25cbb179503"}}, "name": "training_1", "state": "SUCCESS", "proxy": {"proxyname": "PacktivityProxyBase", "proxydetails": null}, "timestamps": {"defined": 1549318217.202308, "ready by": 1549318221.052575, "submit": 1549318217.426669}, "id": "eb8bdb34-b22b-4979-b19f-d25cbb179503", "result": {"training_file": "/home/irina/Projects/madminer/encapsulation/workflows/workdir/training_1/output.txt"}}], "edges": [["2961f93a-00a4-4d91-bf16-73e7ba96bb28", "eb8bdb34-b22b-4979-b19f-d25cbb179503"], ["2961f93a-00a4-4d91-bf16-73e7ba96bb28", "5effdee9-6a23-4c9f-a9a1-329cd10e77e7"], ["18b28d74-fa2e-451a-85d7-89814d04a7e9", "2961f93a-00a4-4d91-bf16-73e7ba96bb28"], ["18b28d74-fa2e-451a-85d7-89814d04a7e9", "5effdee9-6a23-4c9f-a9a1-329cd10e77e7"], ["18b28d74-fa2e-451a-85d7-89814d04a7e9", "eb8bdb34-b22b-4979-b19f-d25cbb179503"]]}, "stepsbystage": {"init": [{"_nodeid": "18b28d74-fa2e-451a-85d7-89814d04a7e9"}], "training": [{"_nodeid": "5effdee9-6a23-4c9f-a9a1-329cd10e77e7"}, {"_nodeid": "eb8bdb34-b22b-4979-b19f-d25cbb179503"}], "sampling": [{"_nodeid": "2961f93a-00a4-4d91-bf16-73e7ba96bb28"}]}, "rules": [], "values": {}, "bookkeeping": {"_meta": {"stages": ["d4264f9d-38a8-408f-87fc-4641f882ee45", "ef18f3c3-6f3c-4ce4-80de-d449f2a6b6a9", "e6009a20-6641-44e6-b1d2-eae42d97974c"], "steps": ["18b28d74-fa2e-451a-85d7-89814d04a7e9", "2961f93a-00a4-4d91-bf16-73e7ba96bb28", "5effdee9-6a23-4c9f-a9a1-329cd10e77e7", "eb8bdb34-b22b-4979-b19f-d25cbb179503"]}}}